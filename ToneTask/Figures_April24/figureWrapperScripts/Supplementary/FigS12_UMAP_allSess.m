function FigS12_UMAP_allSess

fig2  = figure;
set(fig2,'Renderer','painters')
set(fig2,'Color','w')
set(fig2,'Position',[680 65 1225 962]);

sess = {'IZ39_220714_sess18','IZ39_220707_sess17','IZ39_220702_sess14',...
    'IZ40_220707_sess16','IZ40_220708_sess17',...
    'IZ43_220913_sess11','IZ43_220915_sess13','IZ43_220828_sess4','IZ43_220919_sess14',...
    'IZ44_220912_sess10','IZ44_220913_sess11','IZ44_220830_sess7','IZ44_220919_sess14',...
    'IZ47_230626_sess15','IZ47_230707_sess24','IZ47_230710_sess25','IZ47_230712_sess27',...
    'IZ48_230628_sess17','IZ48_230703_sess21','IZ48_230705_sess22','IZ48_230714_sess28'};

TRIAL_TYPE = [0 1 2 3 4 5];
col = [238/255 67/255 69/255;...
    241/255 114/255 42/255;...
    247/255 149/255 33/255;...
    249/255 197/255 81/255;...
    143/255 189/255 107/255;...
    87/255 116/255 144/255];

A = [0,17,199,-6,92,-4,-45,-182,-335,153,1851,180,101,-9,-74,-98,9,179,-3,-183,-265];
E = [90,0,-56,90,0,-66,5,-2,-90,90,-1.7,-2,11,-43,90,1.69,-90,90,-2,53,57];

numrow = 6;
numcol = 8;

rowloc = [1 1 1,...
    2 2,...
    3 3 3 3,...
    4 4 4 4,...
    5 5 5 5,...
    6 6 6 6];

colloc = [1 3 5,...
    1 3,...
    1 3 5 7,...
    1 3 5 7,...
    1 3 5 7,...
    1 3 5 7];

%% Estimate number of tone cells in each session
load('Z:\Homes\zutshi01\Recordings\Auditory_Task\Compiled\compilePlaceFields.mat')
ss=2;
sessIndices = [21 23 20 25 26 33 35 29 34 41 42 40 43 46 47 48 49 50 51 52 53];
for ll = 1:length(sessIndices)
    sumActive(ll) = sum(Summary.AllsessType==(ss-1) & Summary.AllcellType == 1 & nanmean(Summary.AllspaceMapAvg,2)>0.2 & Summary.AllsessID==sessIndices(ll)); 
    sumMaps(ll) = sum(Summary.AllsessType==(ss-1) & Summary.AllcellType == 1 & Summary.AlltoneField & Summary.AlltoneCorr>0.1 & Summary.AllsessID==sessIndices(ll)); 
end
sessFractTuned = [sumMaps./sumActive];
sessActive = sumActive;

sessName= {'IZ41\Final\IZ41_220624_sess5','IZ41\Final\IZ41_220701_sess9',...
    'IZ41\Final\IZ41_220704_sess11','IZ41\Final\IZ41_220708_sess13',...
    'IZ41\Final\IZ41_220629_sess7','IZ41\Final\IZ41_220714_sess14',...
    'IZ45\Final\IZ45_230410_sess11','IZ45\Final\IZ45_230420_sess19',...
    'IZ45\Final\IZ45_230414_sess15','IZ45\Final\IZ45_230417_sess16','IZ45\Final\IZ45_230424_sess21',... 
    'IZ46\Final\IZ46_230406_sess9','IZ46\Final\IZ46_230407_sess10',...
    'IZ46\Final\IZ46_230410_sess11','IZ46\Final\IZ46_230413_sess14','IZ46\Final\IZ46_230420_sess19'...    16
    'IZ39\Final\IZ39_220622_sess8','IZ39\Final\IZ39_220624_sess10','IZ39\Final\IZ39_220629_sess12',...
    'IZ39\Final\IZ39_220702_sess14','IZ39\Final\IZ39_220714_sess18',...
    'IZ39\Final\IZ39_220705_sess16','IZ39\Final\IZ39_220707_sess17',...   23
    'IZ40\Final\IZ40_220705_sess15','IZ40\Final\IZ40_220707_sess16',...
    'IZ40\Final\IZ40_220708_sess17','IZ40\Final\IZ40_220714_sess18',...27
    'IZ43\Final\IZ43_220826_sess2','IZ43\Final\IZ43_220828_sess4',...
    'IZ43\Final\IZ43_220830_sess6','IZ43\Final\IZ43_220901_sess8',...
    'IZ43\Final\IZ43_220911_sess9','IZ43\Final\IZ43_220913_sess11','IZ43\Final\IZ43_220919_sess14',...
    'IZ43\Final\IZ43_220915_sess13','IZ43\Final\IZ43_220920_sess15',...    36
    'IZ44\Final\IZ44_220827_sess4', 'IZ44\Final\IZ44_220828_sess5',...
    'IZ44\Final\IZ44_220829_sess6','IZ44\Final\IZ44_220830_sess7',...
    'IZ44\Final\IZ44_220912_sess10','IZ44\Final\IZ44_220913_sess11','IZ44\Final\IZ44_220919_sess14',...
    'IZ44\Final\IZ44_220915_sess13','IZ44\Final\IZ44_220920_sess15',... 45
    'IZ47\Final\IZ47_230626_sess15','IZ47\Final\IZ47_230707_sess24',...
    'IZ47\Final\IZ47_230710_sess25','IZ47\Final\IZ47_230712_sess27',...49
    'IZ48\Final\IZ48_230628_sess17','IZ48\Final\IZ48_230703_sess21',...
    'IZ48\Final\IZ48_230705_sess22','IZ48\Final\IZ48_230714_sess28'};    

for ss = 1:length(sess)
    umap_path = strcat('Z:\Buzsakilabspace\LabShare\WinnieYang\Ipshita\NatureRevisions\',sess{ss},'\manifold');
    cd(umap_path)
    load(strcat('Z:\Buzsakilabspace\LabShare\WinnieYang\Ipshita\NatureRevisions\',sess{ss},'\',sess{ss},'.spikes.cellinfo.mat'))
    load(strcat('Z:\Buzsakilabspace\LabShare\WinnieYang\Ipshita\NatureRevisions\',sess{ss},'\',sess{ss},'.TrialBehavior.Behavior.mat'))
    if ss>13
        perf = sum(behavTrials.correct(behavTrials.linTrial==0 & behavTrials.probe==0))./length(behavTrials.correct(behavTrials.linTrial==0 & behavTrials.probe==0));
    else
        perf = sum(behavTrials.correct(behavTrials.linTrial==0 & behavTrials.stim==0))./length(behavTrials.correct(behavTrials.linTrial==0 & behavTrials.stim==0));
    end
    umap_name = 'behavior_speed_1_smooth_5_bin_0.1';
    file = dir('*.position_behavior_speed_1_smooth_5_bin_0.1.mat');
    behav_file = file.name;
    manifoldPlot('figHandle',fig2,'umap_name',umap_name,'behav_file',behav_file,'addPosPlot',true,'poscutOff',5,'speedThresh',5,...
        'numrow',numrow,'numcol',numcol,'rowloc',rowloc(ss),'colloc',colloc(ss),'col',col,'TRIAL_TYPE', TRIAL_TYPE,'A',A(ss),'E',E(ss),'dotSize',2)
    subplot(numrow,numcol,numcol*(rowloc(ss)-1)+colloc(ss))
    title(strcat(sessName{sessIndices(ss)}(12:end),'|',num2str(spikes.numcells), '|',num2str(perf),'|',num2str(sessFractTuned(ss))))
end


expPath = 'Z:\Homes\zutshi01\Recordings\Auditory_Task\Compiled\Figures_April2024\SuppFigures\';
saveas(gcf,strcat(expPath,'SupFigure12_UMAPallSess.png'));
saveas(gcf,strcat(expPath,'SupFigure12_UMAPallSess.eps'),'epsc');
saveas(gcf,strcat(expPath,'SupFigure12_UMAPallSess.fig'));
end
