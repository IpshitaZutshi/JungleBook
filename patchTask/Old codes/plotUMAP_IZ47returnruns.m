fig2 = figure;
set(fig2, 'Renderer','painters')
set(fig2,'Position',[1 41 1920 970])

umap_path = 'Z:\Buzsakilabspace\LabShare\WinnieYang\Ipshita\NatureRevisions\IZ47_230626_sess15\manifold';
umap_name = 'behavior_speed_1_smooth_5_bin_0.1';
behav_file = 'Z:\Buzsakilabspace\LabShare\WinnieYang\Ipshita\NatureRevisions\IZ47_230626_sess15\manifold\IZ47_230626_sess15.position_behavior_speed_1_smooth_5_bin_0.1.mat';
%A = -1.17; E = -31.94;
A = -59.8364; E = -4.0112;

% col = [83/255 0/255 0/255;...
%     184/255 15/255 10/255;...
%     241/255 114/255 42/255;...
%     249/255 197/255 81/255;...
%     143/255 189/255 107/255;...
%     87/255 116/255 144/255;...
%     255/255 127/255 127/255;...
%     251/255 182/255 209/255;...
%     253/255 202/255 162/255;...
%     255/255 250/255 129/255;...
%     224/255 243/255 176/255;...
%     154/255 206/255 223/255];

col = [83/255 0/255 0/255;...
    184/255 15/255 10/255;...
    241/255 114/255 42/255;...
    249/255 197/255 81/255;...
    143/255 189/255 107/255;...
    87/255 116/255 144/255;...
    155/255 155/255 155/255];

% First, forward and return
TRIAL_TYPE = [0 1 2 3 4 5 7];% 9 10 11 12 13 14];
manifoldPlot('figHandle',fig2,'umap_path',umap_path,'behav_file',behav_file,'umap_name',umap_name,...
    'numrow',3,'numcol',3,'rowloc',1,'colloc',1,'col',col,'dotSize',5,'TRIAL_TYPE', TRIAL_TYPE,'A',A,'E',E)

% Next, only return
TRIAL_TYPE = [9:14];
col = [83/255 0/255 0/255;...
    184/255 15/255 10/255;...
    241/255 114/255 42/255;...
    249/255 197/255 81/255;...
    143/255 189/255 107/255;...
    87/255 116/255 144/255];

manifoldPlot_separateReturns('figHandle',fig2,'umap_path',umap_path,'behav_file',behav_file,'umap_name',umap_name,'poscutOff',4,'speedThresh',3,...
    'numrow',3,'numcol',3,'rowloc',2,'colloc',1,'col',col,'addSpeed',true,'error',1,'TRIAL_TYPE', TRIAL_TYPE,'A',A,'E',E)

% Next, only forward
TRIAL_TYPE = [0:5];
col = [83/255 0/255 0/255;...
    184/255 15/255 10/255;...
    241/255 114/255 42/255;...
    249/255 197/255 81/255;...
    143/255 189/255 107/255;...
    87/255 116/255 144/255];
    
manifoldPlot_separateReturns('figHandle',fig2,'umap_path',umap_path,'behav_file',behav_file,'umap_name',umap_name,...
    'numrow',3,'numcol',3,'rowloc',3,'colloc',1,'col',col,'addSpeed',true,'error',1,'TRIAL_TYPE', TRIAL_TYPE,'A',A,'E',E)


expPath = 'Z:\Homes\zutshi01\Recordings\Auditory_Task\Compiled\Figures_April2024\Revision2';
saveas(gcf,strcat(expPath,'UMAP_returnRuns.png'));
saveas(gcf,strcat(expPath,'UMAP_returnRuns.eps'),'epsc');
saveas(gcf,strcat(expPath,'UMAP_returnRuns.fig'));
